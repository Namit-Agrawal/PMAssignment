returns <- cbind(ClCl(GLDa),ClCl(USOa),ClCl(VNQa),ClCl(BNOa),ClCl(SLVa))
returns
all.r <- as.matrix(na.omit(returns))
all.r
returns
n <- nrow(all.r)
pairs(all.r)
return.day <- resample(all.r,1,orig.ids = FALSE)
return.day
?return.day
?resmaple
?resample
set.seed(1)
return.day <- resample(all.r,1,orig.ids = FALSE)
return.day
weights <- rep(0.2,5)
weights
holdings <- total*weights
total <- 100000
weights <- rep(0.2,5)
holdings <- total*weights
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
}
holdings
sum(holdings)
boot.portfolio
#wealth <- c()
boot.portfolio <- c()
set.seed(1)
for (i in 1:5000){
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
#wealth <- c(wealth,holdings)
}
boot.portfolio <- c(boot.portfolio,sum(holdings))
}
boot.portfolio
boot.portfolio <- c()
set.seed(1)
for (i in 1:5000){
total <- 100000
weights <- rep(0.2,5)
holdings <- total * weights
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
#wealth <- c(wealth,holdings)
}
boot.portfolio <- c(boot.portfolio,sum(holdings))
}
boot.portfolio
hist(boot.portfolio)
boot.portfolio <- c()
set.seed(1)
for (i in 1:10000){
total <- 100000
weights <- rep(0.2,5)
holdings <- total * weights
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
#wealth <- c(wealth,holdings)
}
boot.portfolio <- c(boot.portfolio,sum(holdings))
}
hist(boot.portfolio)
return.day
1 + return.day
set.seed(1)
for (i in 1:5000){
total <- 100000
weights <- c(0.2,0.5,0.05,0.15,0.1)
holdings <- total * weights
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
#wealth <- c(wealth,holdings)
}
boot.portfolio <- c(boot.portfolio,sum(holdings))
}
hist(boot.portfolio)
mystocks
set.seed(1)
for (i in 1:5000){
total <- 100000
weights <- rep(0.1,0.1,0.6,0.1,0.1)
holdings <- total * weights
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
#wealth <- c(wealth,holdings)
}
boot.portfolio <- c(boot.portfolio,sum(holdings))
}
hist(boot.portfolio)
boot.portfolio
summary(boot.portfolio)
boot.portfolio[which(boot.porfolio == 0),]
boot.portfolio[which(boot.portfolio == 0),]
boot.portfolio[which(boot.portfolio == 0)]
return.day[which.min(boot.portfolio),]
wealth <- c()
set.seed(1)
for (i in 1:5000){
total <- 100000
weights <- rep(0.1,0.1,0.6,0.1,0.1)
holdings <- total * weights
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
wealth <- c(wealth,holdings)
}
boot.portfolio <- c(boot.portfolio,sum(holdings))
}
hist(boot.portfolio)
wealth
mystocks
set.seed(1)
for (i in 1:5000){
total <- 100000
weights <- rep(1,0,0,0,0)
holdings <- total * weights
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
#wealth <- c(wealth,holdings)
}
boot.portfolio <- c(boot.portfolio,sum(holdings))
}
hist(boot.portfolio)
set.seed(1)
for (i in 1:5000){
total <- 100000
weights <- c(0.1,0.1,0.6,0.1,0.1)
holdings <- total * weights
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
#wealth <- c(wealth,holdings)
}
boot.portfolio <- c(boot.portfolio,sum(holdings))
}
hist(boot.portfolio)
boot.portfolio
hist(boot.portfolio)
graphics.off()
set.seed(1)
for (i in 1:5000){
total <- 100000
weights <- c(0.1,0.1,0.6,0.1,0.1)
holdings <- total * weights
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
#wealth <- c(wealth,holdings)
}
boot.portfolio <- c(boot.portfolio,sum(holdings))
}
hist(boot.portfolio)
all.r
all.r[,1]
max(all.r[,1])
summary(boot.portfolio)
set.seed(1)
for (i in 1:5000){
total <- 100000
weights <- rep(0.2,5)
holdings <- total * weights
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
#wealth <- c(wealth,holdings)
}
boot.portfolio <- c(boot.portfolio,sum(holdings))
}
hist(boot.portfolio)
boot.portfolio <- c()
set.seed(1)
for (i in 1:5000){
total <- 100000
weights <- rep(0.2,5)
holdings <- total * weights
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
#wealth <- c(wealth,holdings)
}
boot.portfolio <- c(boot.portfolio,sum(holdings))
}
hist(boot.portfolio)
boot.portfolio <- c()
set.seed(1)
for (i in 1:5000){
total <- 100000
weights <- c(0.1,0.1,0.6,0.1,0.1)
holdings <- total * weights
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
#wealth <- c(wealth,holdings)
}
boot.portfolio <- c(boot.portfolio,sum(holdings))
}
hist(boot.portfolio)
boot.portfolio <- c()
set.seed(1)
for (i in 1:5000){
total <- 100000
weights <- c(1,0,0,0,0)
holdings <- total * weights
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
#wealth <- c(wealth,holdings)
}
boot.portfolio <- c(boot.portfolio,sum(holdings))
}
hist(boot.portfolio)
boot.portfolio1 <- c()
set.seed(1)
for (i in 1:5000){
total <- 100000
weights <- rep(0.2,5)
holdings <- total * weights
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
#wealth <- c(wealth,holdings)
}
boot.portfolio1 <- c(boot.portfolio,sum(holdings))
}
#wealth <- c()
boot.portfolio2 <- c()
set.seed(1)
for (i in 1:5000){
total <- 100000
weights <- c(1,0,0,0,0)
holdings <- total * weights
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
#wealth <- c(wealth,holdings)
}
boot.portfolio <- c(boot.portfolio2,sum(holdings))
}
#wealth <- c()
boot.portfolio3 <- c()
set.seed(1)
for (i in 1:5000){
total <- 100000
weights <- c(0.1,0.1,0.6,0.1,0.1)
holdings <- total * weights
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
#wealth <- c(wealth,holdings)
}
boot.portfolio3 <- c(boot.portfolio,sum(holdings))
}
par(mfrow = c(1,3))
hist(boot.portfolio1)
hist(boot.portfolio2)
hist(boot.portfolio3)
boot.portfolio1 <- c()
set.seed(1)
for (i in 1:5000){
total <- 100000
weights <- rep(0.2,5)
holdings <- total * weights
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
#wealth <- c(wealth,holdings)
}
boot.portfolio1 <- c(boot.portfolio1,sum(holdings))
}
#wealth <- c()
boot.portfolio2 <- c()
set.seed(1)
for (i in 1:5000){
total <- 100000
weights <- c(1,0,0,0,0)
holdings <- total * weights
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
#wealth <- c(wealth,holdings)
}
boot.portfolio2 <- c(boot.portfolio2,sum(holdings))
}
#wealth <- c()
boot.portfolio3 <- c()
set.seed(1)
for (i in 1:5000){
total <- 100000
weights <- c(0.1,0.1,0.6,0.1,0.1)
holdings <- total * weights
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
#wealth <- c(wealth,holdings)
}
boot.portfolio3 <- c(boot.portfolio3,sum(holdings))
}
hist(boot.portfolio1)
hist(boot.portfolio2)
hist(boot.portfolio3)
par(mfrow = c(1,1))
hist(boot.portfolio1)
hist(boot.portfolio2)
hist(boot.portfolio3)
hist(boot.portfolio1)
hist(boot.portfolio2)
hist(boot.portfolio3)
summary(boot.portfolio1)
summary(boot.portfolio1)
summary(boot.portfolio2)
summary(boot.portfolio3)
mystocks <- c("GLD","USO","VNQ","BNO","SLV")
getSymbols(mystocks,from = "2014-01-01")
GLDa <- adjustOHLC(GLD)
USOa <- adjustOHLC(USO)
VNQa <- adjustOHLC(VNQ)
BNOa <- adjustOHLC(BNO)
SLVa <- adjustOHLC(SLV)
returns <- cbind(ClCl(GLDa),ClCl(USOa),ClCl(VNQa),ClCl(BNOa),ClCl(SLVa))
all.r <- as.matrix(na.omit(returns))
n <- nrow(all.r)
#wealth <- c()
boot.portfolio1 <- c()
set.seed(1)
for (i in 1:5000){
total <- 100000
weights <- rep(0.2,5)
holdings <- total * weights
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
#wealth <- c(wealth,holdings)
}
boot.portfolio1 <- c(boot.portfolio1,sum(holdings))
}
#wealth <- c()
boot.portfolio2 <- c()
set.seed(1)
for (i in 1:5000){
total <- 100000
weights <- c(1,0,0,0,0)
holdings <- total * weights
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
#wealth <- c(wealth,holdings)
}
boot.portfolio2 <- c(boot.portfolio2,sum(holdings))
}
#wealth <- c()
boot.portfolio3 <- c()
set.seed(1)
for (i in 1:5000){
total <- 100000
weights <- c(0.1,0.1,0.6,0.1,0.1)
holdings <- total * weights
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
#wealth <- c(wealth,holdings)
}
boot.portfolio3 <- c(boot.portfolio3,sum(holdings))
}
hist(boot.portfolio1)
hist(boot.portfolio2)
hist(boot.portfolio3)
summary(boot.portfolio1)
summary(boot.portfolio2)
summary(boot.portfolio3)
hist(boot.portfolio1)
hist(boot.portfolio2)
hist(boot.portfolio3)
hist(boot.portfolio1)
hist(boot.portfolio2)
hist(boot.portfolio3)
summary(boot.portfolio1)
summary(boot.portfolio2)
summary(boot.portfolio3)
boot.portfolio1 <- c()
set.seed(1)
for (i in 1:5000){
total <- 100000
weights <- rep(0.2,5)
holdings <- total * weights
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
#wealth <- c(wealth,holdings)
}
boot.portfolio1 <- c(boot.portfolio1,sum(holdings))
}
#wealth <- c()
boot.portfolio2 <- c()
set.seed(1)
for (i in 1:5000){
total <- 100000
weights <- c(0.96,0.01,0.01,0.01,0.01)
holdings <- total * weights
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
#wealth <- c(wealth,holdings)
}
boot.portfolio2 <- c(boot.portfolio2,sum(holdings))
}
#wealth <- c()
boot.portfolio3 <- c()
set.seed(1)
for (i in 1:5000){
total <- 100000
weights <- c(0.1,0.1,0.6,0.1,0.1)
holdings <- total * weights
for (i in 1:20){
return.day <- resample(all.r,1,orig.ids = FALSE)
holdings <- holdings*(1+return.day)
#wealth <- c(wealth,holdings)
}
boot.portfolio3 <- c(boot.portfolio3,sum(holdings))
}
hist(boot.portfolio1)
hist(boot.portfolio2)
hist(boot.portfolio3)
summary(boot.portfolio1)
summary(boot.portfolio2)
summary(boot.portfolio3)
boot.portfolio1
initial_wealth = 10000
sim1 = foreach(i=1:5000, .combine='rbind') %do% {
total_wealth = initial_wealth
weights = c(0.2, 0.2, 0.2, 0.2, 0.2)
holdings = weights * total_wealth
n_days = 10
wealthtracker = rep(0, n_days)
for(today in 1:n_days) {
return.today = resample(all_returns, 1, orig.ids=FALSE)
holdings = holdings + holdings*return.today
total_wealth = sum(holdings)
wealthtracker[today] = total_wealth
}
wealthtracker
}
install.packages('foreach')
library(foreach)
initial_wealth = 10000
sim1 = foreach(i=1:5000, .combine='rbind') %do% {
total_wealth = initial_wealth
weights = c(0.2, 0.2, 0.2, 0.2, 0.2)
holdings = weights * total_wealth
n_days = 10
wealthtracker = rep(0, n_days)
for(today in 1:n_days) {
return.today = resample(all_returns, 1, orig.ids=FALSE)
holdings = holdings + holdings*return.today
total_wealth = sum(holdings)
wealthtracker[today] = total_wealth
}
wealthtracker
}
# each row is a simulated trajectory
# each column is a data
head(sim1)
hist(sim1[,n_days], 25)
# Profit/loss
mean(sim1[,n_days])
mean(sim1[,n_days] - initial_wealth)
hist(sim1[,n_days]- initial_wealth, breaks=30)
# 5% value at risk:
quantile(sim1[,n_days]- initial_wealth, prob=0.05)
all_returns = as.matrix(na.omit(returns))
initial_wealth = 10000
sim1 = foreach(i=1:5000, .combine='rbind') %do% {
total_wealth = initial_wealth
weights = c(0.2, 0.2, 0.2, 0.2, 0.2)
holdings = weights * total_wealth
n_days = 10
wealthtracker = rep(0, n_days)
for(today in 1:n_days) {
return.today = resample(all_returns, 1, orig.ids=FALSE)
holdings = holdings + holdings*return.today
total_wealth = sum(holdings)
wealthtracker[today] = total_wealth
}
wealthtracker
}
# each row is a simulated trajectory
# each column is a data
head(sim1)
hist(sim1[,n_days], 25)
# Profit/loss
mean(sim1[,n_days])
mean(sim1[,n_days] - initial_wealth)
hist(sim1[,n_days]- initial_wealth, breaks=30)
# 5% value at risk:
quantile(sim1[,n_days]- initial_wealth, prob=0.05)
boot.portfolio1
changes <- boot.portfolio1 - 100000
changes
quantile(changes,prob = 0.05)
abs(quantile(changes,prob = 0.05))
abs(quantile(boot.portfolio1 - 100000,prob = 0.05))
abs(quantile(boot.portfolio2 - 100000,prob = 0.05))
abs(quantile(boot.portfolio3 - 100000,prob = 0.05))
